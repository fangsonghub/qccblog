<!DOCTYPE html>
<html>
    <head>
	<title>Quantum-secure Pseudorandom Permutations // Quantized Complex Crypto</title>

	    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">
	    <meta property="og:title" content="Quantum-secure Pseudorandom Permutations" />
    <meta property="og:description" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:url" content="http://qcc.fangsong.info/2017-06-quantumprp/" />
    

	<link href="" rel="alternate" type="application/rss+xml" title="Quantized Complex Crypto" />
	
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather|Raleway|Oswald|Lato">
	
	 <link href="http://qcc.fangsong.info/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
	 <link href="http://qcc.fangsong.info/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">

	<link rel="stylesheet" href="http://qcc.fangsong.info/css/style.css">

	<link href="http://gmpg.org/xfn/11" rel="profile">
	
	<meta name="generator" content="Hugo 0.21" />

	
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

	
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/androidstudio.min.css">
	<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	
	
	<link rel="apple-touch-icon" sizes="57x57" href="http://qcc.fangsong.info/img/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="http://qcc.fangsong.info/img/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="http://qcc.fangsong.info/img/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="http://qcc.fangsong.info/img/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="http://qcc.fangsong.info/img/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="http://qcc.fangsong.info/img/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="http://qcc.fangsong.info/img/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="http://qcc.fangsong.info/img/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://qcc.fangsong.info/img/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="http://qcc.fangsong.info/img/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://qcc.fangsong.info/img/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="http://qcc.fangsong.info/img/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://qcc.fangsong.info/img/favicon/favicon-16x16.png">
<link rel="manifest" href="http://qcc.fangsong.info/img/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="http://qcc.fangsong.info/img/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


    </head>


<body>
<div id="container">
    <header id="header">
    <div id="header-outer" class="outer">
        <div id="header-inner" class="inner">
            <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
            <a id="logo" class="logo-text" href="http://qcc.fangsong.info/">Quantized Complex Crypto</a>
            <nav id="main-nav">
                
                <a class="main-nav-link hvr-grow" href="/post/"><i class='fa fa-list fa-fw'></i>Archive</a>
                
                <a class="main-nav-link hvr-grow" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
                
                <a class="main-nav-link hvr-grow" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
                
		<a class ="main-nav-link hvr-grow" href="http://qcc.fangsong.info/index.xml" type="application/rss+xml" target="_blank" title="RSS"><i class="fa fa-rss fa-fw"></i>RSS</a>
            </nav>
            <nav id="sub-nav">
                <div id="search-form-wrap">
                </div>
            </nav>
        </div>
    </div>
</header>

    <section id="main" class="outer">
        <article class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        <header class="article-header">
            <h1 class="article-title" itemprop="name">Quantum-secure Pseudorandom Permutations</h1>
        </header>
        
	<div class="article-meta">
    
	<i class="fa fa-calendar fa-fw"></i>
        <time datetime='2017-06-05T00:00:00.000&#43;00:00' itemprop="datePublished">Mon Jun 5 2017</time> &#8226; 
	
	About 17-minute read 
	
	 
    
    <div class="article-meta">
	<i class="fa fa-tags fa-fw"></i>
        
	<a class="article-tag-list-link" href="http://qcc.fangsong.info//tags/quantum-security">quantum security</a>
        
	<a class="article-tag-list-link" href="http://qcc.fangsong.info//tags/psedurandom">psedurandom</a>
        
	<a class="article-tag-list-link" href="http://qcc.fangsong.info//tags/feistel">Feistel</a>
        
    </div>
    
    
</div>

		    

        <div class="article-entry" itemprop="articleBody">
            

<p>This is a long due note concerning constructing <strong>quantum-secure
pseudorandom permutations</strong> (QPRP), a problem that has made my
collaborators
(<a href="https://www.cs.umd.edu/~amchilds/">Andrew Childs</a>, <a href="http://quics.umd.edu/people/shih-han-hung">Shih-Han Hung</a>, <a href="https://scholar.google.ca/citations?user=2uXdu7AAAAAJ">Zhengfeng Ji</a>) and
myself excited as well as disappointed a couple of times over the past
few years. In a way this makes it a perfect fit for the debut post of
this blog.</p>

<p>A while ago, <a href="https://www.cs.princeton.edu/~mzhandry/">Mark Zhandry</a> observed in a <a href="https://eprint.iacr.org/2016/1076">note</a> that
some existing constructions are immediately quantum-secure for simple
reasons, hence confirming the <em>existence</em> of QPRPs. This post aims to:</p>

<ol>
<li>give another simple observation that shows the <em>existence</em> of
QPRP. This is in fact an observation we had a long time ago, but
probably only heard by a few colleagues over drinks.</li>
<li>give a plain summary of Zhandry&rsquo;s observation and discuss its
connection to our observation and other thoughts.</li>
<li>more importantly, depict the current status and the big questions
that remain <strong>unclear</strong> about QPRP, beyond its mere <em>existence</em>. By
sharing our (mostly failed) experience so far on approaching these
problems, we would love to see more people bringing in new ideas.</li>
</ol>

<p>The full article may be long and a bit technical. I will start with a
dense summary assuming you already know the context. Then I will walk
through the whole story, including the basic concepts of
PRPs and the challenges of getting quantum-secure PRPs.</p>

<!-- You can safely skip it if you know about (and probably have suffered
from) the problem. -->

<h1 id="executive-summary-assuming-you-know-the-context">Executive summary (assuming you know the context)</h1>

<p>Informally speaking, a pesudorandom permutation is a permutation that
is <em>indistinguishable</em> from a truly random permutation, agaisnt any
poly-time algorithm that has oracle-access to the given
permutation. The majority of classically secure constructions plugs a
pseudorandom function into variants of a <a href="https://simple.wikipedia.org/wiki/Feistel_cipher">Feistel</a>
network. They are <strong>quantum-secure</strong> if indistinguishability still
holds against efficient quantum algorithms that can
issue <a href="https://en.wikipedia.org/wiki/Quantum_superposition">quantum superposition</a> queries to the oracles. This makes
proving quantum security difficult, and some classically-secure
constructions actually get <a href="http://ieeexplore.ieee.org/document/5513654/">broken</a> (e.g. 3-round
Luby-Rackoff balanced Feistel). Nonetheless, there are sufficient
conditions for quantum security as identified by us and Zhandry, and
as a result, we are safe to say that quantum-secure PRPs do <em>exist</em>
(based on proper computational assumptions, e.g., existence of
quantum-secure PRFs).</p>

<ul>
<li><p><strong>Our observation</strong>: basically we may view the Feistel construction as a
random walk on the permutation group, and if this walk mixes
rapidly, then it implies quantum indistinguishability. Maximally
unbalanced Feistel (a.k.a. Thorp Shuffle) is such an instance.</p></li>

<li><p><strong>Zhandry&rsquo;s observation</strong>: the essence of Zhandry&rsquo;s observation is
that if classical indistinguishability holds to the extreme, namely
against a distinguisher that queries the entire domain (hence
learning the entire permutation), then it remains
quantum-secure. This sounds a very stringent condition, but
classical cryptographers have actually been quite successful along
this line called <em>full security</em>. Several examples are known
(e.g., <a href="https://www.iacr.org/cryptodb/data/paper.php?pubkey=24631">Mix-&amp;-Cut</a> and <a href="https://eprint.iacr.org/2013/560">Sometimes-recurse</a>).</p></li>

<li><p><strong>What else</strong>? The two observations are both strong conditions that
are sufficient for quantum security. We note that the rapid-mixing
condition is even stronger (i.e., it implies full
security). Although we do not need to worry about the existence of
quantum-secure PRPs any more, it is irritating that we are still not
sure how to prove quantum security of the famous Luby-Rackoff
construction. In fact we do not even know if it is secure at all no
matter how many rounds we employ, though personally I&rsquo;m positive
that it must be. More importantly, current existing examples are
very inefficient (compared to classical security with just constant
rounds). Can we find more efficient quantum-secure PRPs?</p></li>
</ul>

<p>Now the full story is at table.</p>

<h1 id="prps-and-quantum-security">PRPs and quantum security</h1>

<p>If you have heard about DES/AES, or more generally <em>block ciphers</em>,
you are already on board with <em>pesudorandom permutations</em> (PRP), which
are just theoretical abstractions of secure block ciphers. Before
digging into more specifics, let me just mention that PRPs are a
fundamental primitive in modern cryptography, and likewise block
ciphers are the workhorse in practical cryptosystems.</p>

<h2 id="what-is-a-prp">What is a PRP?</h2>

<p>Roughly speaking, a PRP is a permutation that is <em>indistinguishable</em>
from a <strong>truly random permutation</strong> as far as any efficient observers
are concerned when the permutations are given as a <em>black-box</em>. More
precisely, let us work with the set \( X = \{0,1\}^{2n}\), and let
\(\Pi = \{\pi \}\) be the collection of permutations on \(X\),
i.e. the symmetric group $S_X$. Then we consider a family of
permutations $\{E_k\} _{k \in \mathcal{K}} \subseteq \Pi $ indexed
by keys in a keyspace $\mathcal{K}$.</p>

<p>At the heart of the definition is a <strong>distinguisher</strong> $A$, which is an
algorithm that is given <em>oracle</em>-access to a primitive $f$. It asks
queries to $f$ and output one bit in the end, and is usually denoted
$A^f$. Now consider the difference in the probabilities that a
distinguisher $A$ outputs 1 after making $q$ queries in two cases:</p>

<p>$$\epsilon(q,\lambda) :=| \Pr_{k\gets \mathcal{K}} [A^{E_k,
E_k^{-1} }() = 1] - \Pr_{\pi \gets \Pi} [A^{\pi,\pi^{-1} }() = 1] |
\, .$$</p>

<ul>
<li>$A$ has access to $E_k$ and its inverse $E_k^{-1}$ for a random
key $k\gets \mathcal{K}$.</li>
<li>$A$ has access to $\pi$ and its inverse $\pi^{-1}$ for a <em>truly
random permutation</em> $\pi \gets \Pi$.</li>
</ul>

<p>This difference $\epsilon(q,n)$ is usually dubbed the distinguishing
<strong>advantage</strong>. Then a PRP is family $\{E_k\}$ so that the advantage
$\epsilon(q,n)$ is tiny (i.e., decreases faster than any inverse
polynomial in $n$) for any $A$ making $q = poly(n)$ queries (and
running in $poly(n)$ time). This is sometimes called a <em>strong</em> PRP in
the sense that both the permutation and its inverse is available to a
distinguisher. If only the forward permutation is allowed, we call the
resulting family a standard PRP. In this post, a PRP means a strong
one unless otherwise specified.</p>

<p>If we consider more generally function families rather than just
permutations, we obtain a similar notion called <em>pseudorandom
functions</em> (PRFs), which are a family of keyed-functions that are
indistinguishable from a <em>truly random function</em>.</p>

<h2 id="how-to-construct-prps">How to construct PRPs?</h2>

<p>Both theoretical and practical constructions are based on the idea of
<em>iteration</em>, where a basic module is iterated with fresh randomness or
different sub-keys. The famous construction in theory is due
to <a href="http://epubs.siam.org/doi/abs/10.1137/0217022">Luby&amp;Rackoff</a> based on the elegant design of
the <a href="https://simple.wikipedia.org/wiki/Feistel_cipher">Feistel</a> network. $\Xi_f$ converts a function $f:
\{0,1\}^{n} \to \{0,1\}^{n}$ into a permutation on
$\{0,1\}^{2n}$ by the simple rule:</p>

<p>$$\Xi_f(x_L,x_R) = (y_L,y_R): y_L = x_R, y_R = x_L\oplus
f(x_R)\, . $$</p>

<p>If we iterate the basic unit $r$ times, we get the $r$-round Feistel
network $\Xi_{f_1,\ldots,f_r}$, and each $f_i$ is called a <em>round</em>
function. Luby and Rackoff proved that 3-round Feistel is a standard
PRP, and 4-round is a (strong) PRP, when each of the round function is
a PRP with independent random keys. Then by a beautiful series of
results, we know the existence of <strong>one-way functions</strong>, functions
that are easy to compute but hard to invert <strong>on-average</strong>, would
imply pseudorandom generators (PRGs), which suffice for PRFs, and
ultimately give rise to PRPs.</p>

<blockquote>
<p>one-way functions &ndash;[HILL]&ndash;&gt; PRGs &ndash;[GMM]&ndash;&gt; PRFs &ndash;[LubyRackoff]&ndash;&gt; PPRs</p>
</blockquote>

<p>The gist of Luby&amp;Rackoff&rsquo;s proof, which is inherent in all most all
analyses, goes in two steps</p>

<p>1) Substituting independently truly random functions for PRFs in
every round. This is legit by a straightforward hybrid argument.</p>

<p>2) Proving <strong>information-theoretically</strong> that the resulting network is
indistinguishable from a truly random permutaion. For example, the
4-round Feistel is shown to be secure up to $\sim \sqrt{2^{2n}}$ queries
against any, possibly <strong>computationally</strong> unbounded, distinguishers.</p>

<p>There are various followups and modern constructions
(e.g., <a href="http://eprint.iacr.org/2010/301">this</a> and <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.149.6371">this</a>). Essentially all analysis
proceeds in this way, and a lot of efforts have been on improving the
information-theoretical bound in step 2).</p>

<h2 id="what-about-quantum-security">What about quantum security?</h2>

<p>Everything sounds sweat so far. But the new player
of <a href="http://www-03.ibm.com/press/us/en/pressrelease/52403.wss">quantum computers</a> will totally change the landscape. You may
have heard about Shor&rsquo;s ground breaking poly-time quantum algorithm
for factorization, which will <a href="https://www.youtube.com/watch?v=vipU_-QGoOg&amp;feature=youtu.be&amp;list=PLUz_4vZOI0H0nfczvYk2C_UbE_BMs8cpY">smash down</a> almost the entire
security infrastructure on the Internet. In current setting, the issue
comes from the unique feature of quantum <strong>superposition</strong>. For a
<strong>quantum</strong> distinguisher, we need to consider &ldquo;superposed&rdquo; queries:</p>

<p>$$\sum_{x\in X}\alpha_x |x,0\rangle \stackrel{f}{\mapsto} \sum_{x
\in X} \alpha_x |x, f(x)\rangle \, .$$</p>

<p>We call a PRP <strong>quantum-secure</strong> (QPRP), if it remains
indistinguishable against any efficient quantum distinguishers that
are equipped with quantum superposition access to the given
permutations.</p>

<p>To be clear, although it seems that in one quantum query, all function
values of $f$ is &ldquo;contained&rdquo; in the response state, the only way that
$A$ can read them out is by a quantum measurement, which will reveal
one $f(x)$ and then collapse the state. Therefore, it is not that a
quantum distinguisher can effortlessly learn $f$ entirely. Rather, the
real difficult is that the proof and analysis we had for classical
distinguishers may not <strong>make sense</strong> anymore. More specifically, if
we look at the two-step proof of Luby&amp;Rackoff:</p>

<p>1&rsquo;) OK, if we use <strong>quantum-secure</strong> PRFs, which exist assuming
<strong>quantum-secure</strong> one-way functions as shown
by <a href="http://eprint.iacr.org/2012/182">Zhandry12</a>.</p>

<p>2&rsquo;) The classical <em>information-theoretical</em> analysis becomes
completely inapplicable. In essence, the analysis goes by defining
&ldquo;bad events&rdquo; in the probability space, which captures the possibility
of seeing a difference in the case of the Feistel construction or a
truly random permutation. Bounding the probability of these &ldquo;bad
events&rdquo; thus bounds the distinguishing advantage too. However, there
is no (or rather we do not know) sensible counterpart of such &ldquo;bad
events&rdquo; when dealing with quantum distinguishers. This is where the
challenge goes wild, mainly due to our lacking of tools in reasoning
about quantum attackers.</p>

<h3 id="3-round-feistel-broken">3-round Feistel broken</h3>

<p>To make things worse, it was shown that <a href="http://ieeexplore.ieee.org/document/5513654/">3-round</a> Feistel is
<strong>broken</strong> by quantum distinguishers using Simon&rsquo;s algorithm, the
inspiration of Shor&rsquo;s algorithm. While this attack does not seem to
generalize to 4 rounds, we did not know if 4-round Feistel is
quantum-secure (even in the standard sense i.e., without inverse
permutations), or how many rounds will make it quantum-secure if any
at all. In fact, whether there exists a QPRP, by any possible
construction under reasonable assumptions, was in doubt.</p>

<h1 id="existence-of-qprps">Existence of QPRPs</h1>

<p>That was the status when we (<a href="https://www.cs.umd.edu/~amchilds/">Andrew Childs</a>, <a href="https://scholar.google.ca/citations?user=2uXdu7AAAAAJ">Zhengfeng Ji</a>
and myself, all at <a href="https://uwaterloo.ca/institute-for-quantum-computing/">IQC</a> then) started thinking about this
problem. We were optimistic and decided to salvage the Luby-Rackoff
proof against quantum attacks. Out of various attempts, one approach
based on rapid mixing of random walks seemed promising and left with
us an observation that shows the <em>existence</em> of QPRP, which we thought
insignificant back then (early 2014). None of us had imagined that it
was till last summer (2016) that we resumed on this hanging problem,
with a fresh mind joining force - <a href="http://quics.umd.edu/people/shih-han-hung">Shih-Han Hung</a>, Andrew&rsquo;s Ph.D
student at UMD. We realized a few months later that the mixing
approach would very likely fail on Balanced Feistel based on a
counting argument. Let me come back to this later, and let good news
come first.</p>

<h2 id="our-observation-quantum-prps-exist-based-on-rapid-mixing">Our observation: quantum PRPs exist based on Rapid Mixing</h2>

<p>What we observed in early 2014 was that at least <em>existence</em> of QPRPs
should not bother us anymore. Basically one can view any iterated
construction (e.g. $\Xi_{f_1,\ldots, f_r}$) as an $r$-step random
walk on the symmetric group $S_X$. Namely we start from the identity
permutation, and then the random choice of round function $f_i$
determines the transition at each step. Suppose that the walk has
uniform <a href="https://en.wikipedia.org/wiki/Stationary_distribution">stationary distribution</a> and it converges up to
statistical error $\delta$ within $r$ steps. This will imply that the
resulting permutation $\Xi_{f_1,\ldots, f_r}$ is the <em>same</em> as
drawing a truly random permutation, except with error at most
$\delta$. Therefore, <strong>information-theoretically</strong>, no adversary
(classical nor quantum) can tell a difference regardless of the number
of queries and how much time s/he spends on it. This still holds if
both $\pi$ and $\pi^{-1}$ are given to the adversary. This would
justify step 2) against quantum distinguishers. Everything here can be
made formal. This idea is not new at all (e.g., <a href="http://epubs.siam.org/doi/abs/10.1137/050636231?journalCode=smjcat">Morris08</a>).</p>

<p><a
href="https://commons.wikimedia.org/wiki/File:Random_walk_25000_not_animated.svg#/media/File:Random_walk_25000_not_animated.svg"><img height="180" width="180"
src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/Random_walk_25000_not_animated.svg/1200px-Random_walk_25000_not_animated.svg.png"
alt="Random walk 25000 not animated.svg"></a></p>
<p style="text-align:center">By <a
href="//commons.wikimedia.org/wiki/User:Nl74" title="User:Nl74">László
Németh</a> - <a
href="http://creativecommons.org/publicdomain/zero/1.0/deed.en"
title="Creative Commons Zero, Public Domain Dedication">CC0</a>, <a
href="https://commons.wikimedia.org/w/index.php?curid=27964423">Link</a></p>

<p>Next, as said earlier, one can replace truly random functions by
quantum-secure PRFs in step 1), and this results in permutations that
are indistinguishable from a truly random permutation against
<em>poly-time</em> quantum adversaries making <em>poly</em>-many queries.</p>

<p>The question then becomes, do we have constructions that mix over
$S_X$ rapidly? Luckily a variation on LubyRackoff construction called
the <strong>maximally-unbalanced</strong> Feistel (Max-UBF), which corresponds
to <a href="http://epubs.siam.org/doi/abs/10.1137/050636231?journalCode=smjcat">Thorp shuffle</a> in the study of card shuffling, has been
shown to <strong>mix rapidly to uniform</strong>. Instead of evenly divide the
input string into two halves in the Luby-Rackoff construction, which we
may call <strong>Balanced Feistel</strong> (BF) hereafter, Max-UBF applies random
round function $f_i:\{0,1\}^{2n-1} \to \{0,1\}$ on all but the
first bit and XOR the one-bit output to the first bit of input. Namely
one-round Max-UBF goes as follows:</p>

<p>$$ (x_1,x_{2,\ldots,2n}) \mapsto (x_{2,\ldots, 2n}, f(x_{2,\ldots,
2n})\oplus x_1) \, . $$</p>

<p>Therefore, we have</p>

<blockquote>
<p><strong>Theorem</strong>. Assuming existence of quantum-secure one-way functions, there exist quantum-secure pseudorandom permutations.</p>
</blockquote>

<p>This is all too easy, isn&rsquo;t it? We thought so too back then, and were
reluctant to write it up. What we wanted to answer is:</p>

<blockquote>
<p>does LubyRackoff construction (Balanced Feistel) also mix rapidly?</p>
</blockquote>

<p>Searching its answer ended up in the negative message found by
Shih-Han. But again, let me defer it till later.</p>

<h3 id="a-word-of-caution">A word of caution</h3>

<p>The idea of random walk is very natural, so natural as we sometimes
fail to recognize what &ldquo;walk&rdquo; we are indeed taking. We stress that we
are considering a random walk over the permutations (each node is a
permutation and the edge connects nodes that are achievable by
composing one-round Feistel with some round function $f$).</p>

<p>In contrast, one may also consider a walk over the <strong>strings</strong>
$\{0,1\}^{2n}$. Namely take an input string $x$, it will get
permuted to a new string $ x^{\prime}$ after sending it through the
Feistel network. We can analyze how fast, if it does, the string
becomes <strong>uniformly</strong> distributed. In cryptographic terms, this shows
(standard, w.o. inverse permutation) indistinguishability against a
single-query, <strong>non-adaptive</strong> (i.e., query $x$ determined in advance)
distinguisher. We can generalize this idea to analyze how a $q$-tuple
$(x_1,\ldots,x_q)$ evolves, and this would establish $q$-query,
non-adaptive security. Indeed, this is the approach many of the
classical works on PRPs take, and this walk on strings is sometimes
called <em>projective</em> walks. It is often easier to analyze than the walk
on the symmetric group. Classical cryptographers are also blessed that
non-adaptive security can be easily <a href="http://eprint.iacr.org/2006/456">amplified</a> by various
forms of composition to achieve stronger security (e.g., adaptive,
strong PRP).</p>

<p>That said, the $q$-<em>projective</em> walk on strings is not totally
unrelated to the walk on the symmetric group. Note that when $q$ is as
big as the entire domain size, these two walks will indeed
coincide. This is not super helpful though, since classical results
are not ususally so strong. But they do exist, and this is exactly
leading us to Zhandry&rsquo;s observation.</p>

<h2 id="zhandry-s-observation-fully-secure-prps-are-quantum-secure">Zhandry&rsquo;s observation: fully-secure PRPs are quantum-secure</h2>

<p>In a recent note by <a href="https://eprint.iacr.org/2016/1076">Zhandry</a>, he noticed another
<strong>sufficient</strong> condition that can make a classically secure PRP also
quantum-secure. He called the constructions satisfying this property a
<em>full-domain Function-to-Permutation Converter</em> (FD-FPC). He then
observed that some classical constructions are indeed FD-FPCs
(e.g., <a href="https://www.iacr.org/cryptodb/data/paper.php?pubkey=24631">Mix-&amp;-Cut</a> and <a href="https://eprint.iacr.org/2013/560">Sometimes-recurse</a> shuffles in the
design of format-preserving encryption). Then similarly once the
random functions in FD-FPCs are replaced by quantum-secure PRFs, one
gets quantum-secure PRPs.</p>

<p>The formal definition and analysis in Zhandry&rsquo;s note are somehow
technical and not so easy to grasp. But the key idea is extremely
simple. FD-FPC is essentially a notion called <em>full security</em> in the
study of format-preserving encryption. Basically it requires that even
if the distinguisher queires the <strong>entire domain</strong> of a given oracle
$\sigma$ drawn according to some distribution, a distinguisher still
cannot tell it apart from a truly random permutation. Clearly such a
distinguisher can completely reconstruct the permutation $\sigma$, and
hence quantum superposition queries do not add any power. Therefore
quantum-secure follows trivially.</p>

<h2 id="reflection-on-the-existence-of-qprps">Reflection on the existence of QPRPs</h2>

<p>Well, both observations indicate that <em>existence</em> of QPRPs is in fact
easy to attain, given the hard work in the literature. Let&rsquo;s
reflect on them a bit, before we ask what&rsquo;s next.</p>

<h3 id="how-about-almost-fd-fpcs">How about <em>almost</em> FD-FPCs?</h3>

<p>Zhandry&rsquo;s FD-FPC (i.e., full security) is very stringent and in some
sense captures <strong>perfectly</strong> indistinguishability. Is it possible to
loose it slightly? For instance, consider an notion of
$\epsilon$-<strong>almost</strong> FD-FPC where we require that after querying a
construction $\sigma$ on all but $N^\epsilon$ elements of the domain
of size $N$, it is still difficult for the distinguisher to tell it
from a truly random permutation. It is likely that, by direct statistical
analysis or some standard techniques in quantum query complexity
(e.g., <a href="https://arxiv.org/abs/quant-ph/9701001">BBBV hybrid method</a>), this notion also implies quantum
security. In fact, Zhandry&rsquo;s definition FD-FPC may already entails
almost FD-FPC when very small $\epsilon$ is concerned.</p>

<h3 id="rapid-mixing-implies-almost-full-security">Rapid mixing implies (almost) full security</h3>

<p>An immediate application about the almost FD-FPC is that rapid mixing
implies almost FD-FPC. This is because rapid mixing means that if one
draws a permutation from some construction $\Xi$ or uniformly random,
they get literally the <strong>same</strong> permutation with the same probability
except with some negligible error. Of course learning the entire truth
table does not tell anything, because the distinguisher is looking at
the same permutation!</p>

<p>In other words, FD-FPC was considering a special family of
distinguishers who query (almost) the entire domain and make a
decision, whereas rapid mixing ensures security for any
distinguishers.</p>

<h3 id="how-was-full-security-proven">How was full security proven?</h3>

<p>You may have been wondering, after all, one still needs some technique
to prove full security. How did people do it? Roughly speaking,
Ristenpart and Yilek in their <a href="https://www.iacr.org/cryptodb/data/paper.php?pubkey=24631">mix-&amp;-cut</a> paper introduced the
<em>icicle</em> technique, which recursively applies an &ldquo;already-good-enough&rdquo;
inner PRP $\sigma$ on shorter inputs. This can be viewed as amplifying
the security of $\sigma$ to full security. What does
&ldquo;already-good-enough&rdquo; mean? It is basically almost FD-FPC that we just
discussed. How to construct and prove a &ldquo;already-good-enough&rdquo; inner
PRP? It turns out, not surprisingly, <em>rapid mixing of random walks</em> is
the hero again. This was demonstrated in the <a href="https://arxiv.org/abs/1208.1176">Swap-or-Not</a>
construction, which is the inner PRP used in both FD-FPCs Zhandry
identified (Mix-&amp;-cut and Sometimes-recurse). Beware that the random
walk studied in Swap-or-Not is the walk on <em>strings</em> rather than
<em>permutations</em>.</p>

<h1 id="what-now">What now?</h1>

<p>Well, maybe we just need to be happy now. But we (maybe just me) are
so annoyed that no quantum security has been said about the original
LubyRackoff&rsquo;s Balanced Feistel (BF) construction.</p>

<blockquote>
<p>how many round are enough, if any, to make the LubyRackoff Balanced Feistel quantum-secure?</p>
</blockquote>

<p>Let&rsquo;s start with the rapid mixing approach? Restating the question we
mentioned earlier</p>

<blockquote>
<p>does LubyRackoff construction (Balanced Feistel) also mix rapidly?</p>
</blockquote>

<p>We were very hopeful. First thing to notice is that balanced Feistel
networks only produce <em>even</em> permutations, i.e., they generate the
alternating group $A_{X}$ as shown by <a href="http://math.boisestate.edu/~liljanab/MATH509/DESAlternatingGroup.pdf">Evan&amp;Goldreich</a> several
decades ago. But this is not a problem, since we can show that a
uniformly random <em>even</em> permutation is indistinguishable from a
uniformly random permutation. So it suffices to have BF mix well in
$A_X$.  We tried several techniques (spectral analysis, coupling
argument as Morris used to show the mixing
of <a href="http://epubs.siam.org/doi/abs/10.1137/050636231?journalCode=smjcat">Max-Unbalanced Feistel</a>), but were not successful.</p>

<p>Then came the embarrassing moment. Shih-Han pointed out that there is
just not enough <strong>randomness</strong> or freedom to produce all even
permutations by BF in poly-many rounds. A simple criterion that
somehow sneaked out of our eyes. Think about how many possible
permutations one round BF is able to generate &ndash; the number of
possible round functions, which is $a = 2^{n2^n}$. So $r$-round
iteration at most gives you $(2^{n2^n})^r = 2^{r n \cdot 2^n}$ many
permutations. But what is the size of alternating group of $2n$-bit
strings? It is $2^{2n}! /2 \approx 2^{2n\cdot 2^{2n}}$. Clearly $r$
needs to be at least $\Omega(2^n)$ to make ends meet.</p>

<p>As a sanity check, the Max-Unbalanced Feistel does not suffer from
this, because there are $2^{2^{2n-1}}$ possible functions each round,
and roughly $2n$ rounds will generate the entire symmetric
group. Indeed Morris showed $O(n^3)$ mixing time.</p>

<p>Is this approach totally doomed? One may identify a subgroup in $A_X$
so that BF mixes rapidly on it and meanwhile a random element there
remains indistinguishable from being truly random. But we do not see a
clear route at present.</p>

<p>Finally note that Zhandry&rsquo;s FD-FPC approach does not help here,
because BF is <strong>NOT</strong> FD-FPC, not even close to almost FD-FPC. Recall
that Balanced Feistel only generates even permutations, whereas a
truly random permutation is eaually liketly to be even or odd. A
distinguisher querying the entire domain can of course reconstrut the
permutation and determine if it is even or odd (with enough
time). Similarly, we could imagine tweaking the definition of FD-FPC
so that we just need the construction to be indistinguishable from a
random even permutation. It still seems unlikely that poly-many rounds
of BF is able to realize this slightly weaker notion of FD-FPC.</p>

<h2 id="open-question-efficient-qprps">Open question: efficient QPRPs</h2>

<p>I am still optimistic about finding a <strong>proof</strong> of its quantum
security (yeah, I do believe it is quantum-secure with not too-many
rounds). As discussed before, we can say so much strong security
classically, and maybe we are just missing a suitable <em>bridge</em>, i.e.,
a sufficient condition for quantum security, which in the meantime
follows from classical security results.</p>

<p>Maybe we (I) should not be too obsessed by balanced Feistel. The more
significant question is probably how to get more efficient QPRPs. The
QPRPs identified so far (e.g., Max-UBF, Mix-Cut Shuffle) need linear
or polynomially many round in $n$. This may be acceptable on small
domain (e.g., constant $n$), but clearly too expensive for large
domains.</p>

<blockquote>
<p>can we construct more efficient QPRPs? e.g., constant number of iterations and calls of PRFs?</p>
</blockquote>

<p>Any ideas? Comments welcome.</p>

        </div>

        
        
        <div class="article-toc" style="display:none;">
            <h3>Contents</h3>
            <nav id="TableOfContents">
<ul>
<li><a href="#executive-summary-assuming-you-know-the-context">Executive summary (assuming you know the context)</a></li>
<li><a href="#prps-and-quantum-security">PRPs and quantum security</a>
<ul>
<li><a href="#what-is-a-prp">What is a PRP?</a></li>
<li><a href="#how-to-construct-prps">How to construct PRPs?</a></li>
<li><a href="#what-about-quantum-security">What about quantum security?</a>
<ul>
<li><a href="#3-round-feistel-broken">3-round Feistel broken</a></li>
</ul></li>
</ul></li>
<li><a href="#existence-of-qprps">Existence of QPRPs</a>
<ul>
<li><a href="#our-observation-quantum-prps-exist-based-on-rapid-mixing">Our observation: quantum PRPs exist based on Rapid Mixing</a>
<ul>
<li><a href="#a-word-of-caution">A word of caution</a></li>
</ul></li>
<li><a href="#zhandry-s-observation-fully-secure-prps-are-quantum-secure">Zhandry&rsquo;s observation: fully-secure PRPs are quantum-secure</a></li>
<li><a href="#reflection-on-the-existence-of-qprps">Reflection on the existence of QPRPs</a>
<ul>
<li><a href="#how-about-almost-fd-fpcs">How about <em>almost</em> FD-FPCs?</a></li>
<li><a href="#rapid-mixing-implies-almost-full-security">Rapid mixing implies (almost) full security</a></li>
<li><a href="#how-was-full-security-proven">How was full security proven?</a></li>
</ul></li>
</ul></li>
<li><a href="#what-now">What now?</a>
<ul>
<li><a href="#open-question-efficient-qprps">Open question: efficient QPRPs</a></li>
</ul></li>
</ul>
</nav>
        </div>
        
        

        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
        <script>
         (function() {
             var $toc = $('#TableOfContents');
             if ($toc.length > 0) {
                 var $window = $(window);

                 function onScroll(){
                     var currentScroll = $window.scrollTop();
                     var h = $('.article-entry h1, .article-entry h2, .article-entry h3, .article-entry h4, .article-entry h5, .article-entry h6');
                     var id = "";
                     h.each(function (i, e) {
                         e = $(e);
                         if (e.offset().top - 10 <= currentScroll) {
                             id = e.attr('id');
                         }
                     });
                     var active = $toc.find('a.active');
                     if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

                     active.each(function (i, e) {
                         $(e).removeClass('active').siblings('ul').hide();
                     });
                     $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                         $(e).children('a').addClass('active').siblings('ul').show();
                     });
                 }

                 $window.on('scroll', onScroll);
                 $(document).ready(function() {
                     $toc.find('a').parent('li').find('ul').hide();
                     onScroll();
                     document.getElementsByClassName('article-toc')[0].style.display = '';
                 });
             }
         })();
        </script>
        
    </div>

    
<div class="post-footer share">
    <span style="font-family: 'Merriweather', 'PT Serif', Georgia, 'Times New Roman', serif;">Share this post</span>
    <a href="https://twitter.com/share?text=Quantum-secure%20Pseudorandom%20Permutations&nbsp;-&nbsp;Quantized%20Complex%20Crypto&amp;url=http%3a%2f%2fqcc.fangsong.info%2f2017-06-quantumprp%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"  title="Twitter"><i class="fa fa-twitter-square fa-fw"></i></a>
    </a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fqcc.fangsong.info%2f2017-06-quantumprp%2f" title="Facebook" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"><i class="fa fa-facebook-square fa-fw"></i></a>    
    <a href="https://plus.google.com/share?url=http%3a%2f%2fqcc.fangsong.info%2f2017-06-quantumprp%2f" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;"  title="GooglePlus"><i class="fa fa-google-plus-square fa-fw"></i></a>
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2fqcc.fangsong.info%2f2017-06-quantumprp%2f" onclick="window.open(this.href, 'linkedin-share', 'width=490,height=530');return false;" title="LinkedIn"><i class="fa fa-linkedin-square fa-fw" aria-hidden="true"></i></a>
    <a  href="mailto:?subject=Quantum-secure%20Pseudorandom%20Permutations&amp;body=Check out this post http%3a%2f%2fqcc.fangsong.info%2f2017-06-quantumprp%2f" onclick="window.open(this.href, 'email-share', 'width=490,height=530');return false;"
	title="Email"><i class="fa fa-envelope fa-fw"></i></a>
    
    </div>




    <nav id="article-nav">
    
    
</nav>


</article>

        
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'quantcc';
    var disqus_identifier = 'http:\/\/qcc.fangsong.info\/2017-06-quantumprp\/';
    var disqus_title = 'Quantum-secure Pseudorandom Permutations';
    var disqus_url = 'http:\/\/qcc.fangsong.info\/2017-06-quantumprp\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        
    </section>
    <footer id="footer">
   <div class="outer">
	 <div id="footer-info" class="inner">
	    <div>
    
    
    <a href="https://twitter.com/fangsongqcc" target="_blank" title="Twitter"><i class="fa fa-twitter-square fa-fw" title="Twitter"></i></a>
    
    
    
    
    <a href="https://github.com/fangsonghub" target="_blank" title="GitHub"><i class="fa fa-github-square fa-fw"></i></a>

    

    
</div>

	    &copy; 2017 Quantized Complex Crypto &middot 
            Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with theme <a href="https://github.com/carsonip/hugo-theme-minos">Minos</a>
        </div>
    </div>
    

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css" integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha256-ExtbCSBuYA7kq1Pz362ibde9nnsHYPt6JxuxYeZbU+c=" crossorigin="anonymous"></script>
    
    <script>renderMathInElement(document.body, {delimiters: [ 
        {left: "$$", right: "$$", display: true},
        {left: "$", right: "$", display: false},
        {left: "\\[", right: "\\]", display: true},
        {left: "\\(", right: "\\)", display: false},
    ]});</script>
    
    <script>
     document.getElementById('main-nav-toggle').addEventListener('click', function () {
         var header = document.getElementById('header');
         if (header.classList.contains('mobile-on')) {
             header.classList.remove('mobile-on');
         } else {
             header.classList.add('mobile-on');
         }
     });
    </script>
</footer>

</div>
</body>
</html>
